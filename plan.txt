1. 도커 개발환경(=배포cicd) 구축
2. cctv rtsp 연결 (파이썬)
3. 웹/앱 개발 (푸시 알림)
  -> 승준연락
4. yoloV5 (근무시간에 해두기)
5. cctv rtsp + yoloV5
  -> 숭오리 주택집 배포



4.-> 기본 detect 기능 확인함.
  - 찾은 물체의 class 정보 ex) person
  - 찾은 class 의 개수 ex) person 2명잇다
  - 원본 이미지에 bounding box 그려진 이미지 저장 경로
1.~5. 먼저 구현 후 경량화나 배포, 새로운 데이터로 학습 등 자세히 보기


2. -> 3. 순서로 하기

그림을 그려보자 다시..
frontend/backend - 워드프레스/mysql 로 결정?
딥러닝 서버

하나의 서버에 도커로 분리해도 될듯


3. 에서도 배워야할게 아주 많다..
우선 필요한 내용 Dynamic DNS 강의 먼저 듣고
ai cctv 는 계속 진도나가고
평일 출근하고 오전 2시간은 그냥 강의 듣는시간으로 fix 해야겠다
내가 Dynamic DNS 의 존재를 알고 있었기 때문에
다시 찾아듣고 활용하려는것 처럼
내가 아는것의 범위가 넓어야 하니까
강의는 계속 꾸준히 들어야겠다.


포트포워딩으로 외부에서 내 리눅스 서버로 접속이 가능하게 되었다.
도메인 이름 하나 따고 Dynamic DNS 적용은 추후에 하자.
계속 인터넷에 접속하면 외부IP 어차피 안바뀌는거 같다


이제 rtsp 차례
c210 rtsp 매뉴얼이 자세히 있다.
pdf 파일 읽어보고 하기.

먼저 리눅스 rtsp 컨테이너에서 c210 rtsp 받아서
이미지 1장 저장이 되는지부터 확인하자.
그러고나서 rtsp 받은걸 flask 로 웹에다가 다시 rtsp 띄우기 해보자.



Class 로 코드 리펙토링.
클래스 변수로 모두 변환.
---.sh 에서 python3 detect4.py arg1 arg2 ...
자동화 가능하도록.


DDNS 설정, case 테스트
1리눅스s, 2CCTV, 3윈도우c, 4스마트폰c
case1) 1,2,3 모두 마곡집 공유기내부네트워크
case2) 1,2-마곡집 / 3-다른와이파이존
case3) 1-마곡집 / 2,3-다른와이파이존




우분투 inotifywait 
파일 써지면 알아채고 mp3 실행.
sox 호스트에 설치되어있고
play /my/dir/asdf.mp3


블루투스 연결도 되네!!!

아빠한테 개 돌아다니는 영상 받고
detect 하면 txt 쓰고

inotifywait 로 txt 발견하면
블루투스 스피커에서 개소리나기






문제가 뭔지 알았음
flask 를 wsgi 없이 써서 3번 접근하면 끝나는줄 알았는데 그게 아녔음
flask 를 gunicorn 으로 띄운다고 해결되는게 아녔음
rtsp 를 여러번 연결하니까 tapo 에서 3번째때 막은것이었음
user 맥시멈 인원수 있다고 함
tapo 앱 1명, rtsp 1회(1명), rtsp 2회(1명) 까지 되고
rtsp 3회(1명) 때 rtsp 연결 불가능하다고 뜸.

코드 구조를 바꿔야됨
url 요청이 없을때 rtsp 에 연결되어서 yolo 는 돌고 있고
url 요청이 있을때 yolo 의 결과값을 yield 하는 방식으로 코드 수정해야됨

이렇게 해서 아래 기능1을 마무리하고 기능2로 넘어가자
기능1 :
사용자가 url 요청했을때 detection 되고 있는 화면이 웹페이지에 보인다
만들 기능
- 버튼 클릭햇을때 video stream 화면으로 넘어가도록하기

기능2 : (완성)
사용자가 아무런 액션을 취하지 않고 있을때
back단에서 yolo 가 돌면서 '사람' 또는 '개' 가 나타났을때
이미지 파일을 저장하고
사용자에게 notification 을 날린다

기능3 :
사용자가 notification 을 발견하고
과거 저장된 이미지를 조회하고자 url 요청을 했을때
해당 이미지를 화면에 보여준다
